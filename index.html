<!DOCTYPE html>
<html style="width:1600px;Height:730px">
<head>
	<meta name="viewport">
	<title>Authoring Tool (Beta - Edit existing content only)</title>
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />	
	<LINK REL="stylesheet" TYPE="text/css" HREF="authtool.css" />	
	<style>
	* {box-sizing: border-box}
	body {font-family: Verdana, sans-serif; margin:0;padding: 5px;}

	body {
		font-family: Roboto, sans-serif;
		color: #58595b;
		font-weight: 300;
		font-size: 16px;
		padding: 5px
	}

	.active, .dot:hover {
	  background-color: #717171;
	}

	.hideElement{
		display:none;
	}
	
	html{
		overflow-x: auto; 
		overflow-y: auto;
	}
	
	ul{
		list-style-type: none;
		margin-left:0px;
		padding-left:0px;
		line-height: 1em;
	}	
	
	p{
		line-height: 2.5;
	}
	select{
		width:100%;
	}
	table{
		width:100%;
	}
	tr{
		width:100%;
	}
	
	.linespacer{
		margin-left:25px;
		margin-top:3px; 
	}

	.menulinespacer{
		padding-left:25px;
		margin-top:3px; 
	}
	
	.categorytitle{
		margin-bottom:5px;
		margin-top:5px;
		background-color:#F5DEB3;	
		color:#A52A2A;
	}
	
	.contentdetail{
		margin-top:0px;
		margin-bottom:10px;
	}
	
	
	
	ul, li { list-style: none; }
	
	li {
	  border: 1px dotted black;
	  border-width: 0 0 1px 1px; 
	}
	/* Main Level */
	ul{
		margin-left:5px;
		padding-left:0px;
		list-style: none;
		border: 1px dotted red;
		border-width: 0 0 0px 1px;				  
	}

	/* Second Level */
	ul ul{
	  margin-left:15px;			 
	}

	/* Third Level */
	ul ul ul{
	  margin-left:15px;
	}
	
	/* Fourth Level */
	ul ul ul ul{
	  margin-left:15px;
	}
	
	li{
		margin-top: 3px;
		padding-left:5px;
		border: 1px dotted red;
		border-width: 0 0 1px 0px;				
		/*border:1px solid grey;*/
	}
	
	li:hover {background-color: #ddd;}
	</style>
	<script>
		//debugger;
		//debugger;
		var params_list = new VBArray(window.dialogArguments);
		var params = params_list.toArray();
		var oDoc =  params[0];
		var oCWApplication = params[1];
		var sClosestSection = params[2];
		var sCType = params[3];
		//var oSortGroups = new ActiveXObject("Scripting.Dictionary");				
		/*	
			Force window to come to the fore/front
			This should resolve the issue of the window being in the background when it has loaded
		*/
		window.focus();
	</script>
	<SCRIPT language="javascript" src="publicvariables.js"></SCRIPT>
	<SCRIPT language="javascript" src="authtool.js"></SCRIPT>
	<SCRIPT language="javascript" src="dragndrop.js"></SCRIPT>
	<SCRIPT language="javascript" src="utilities.js"></SCRIPT>
	<SCRIPT language="javascript" src="style.js"></SCRIPT>	
	<SCRIPT language="javascript" src="onload.js"></SCRIPT>
	<SCRIPT language="javascript" src="preview.js"></SCRIPT>
	<SCRIPT language="javascript" src="highlight.js"></SCRIPT>
	<SCRIPT language="javascript" src="table.js"></SCRIPT>
	<SCRIPT language="javascript" src="section.js"></SCRIPT>
	<SCRIPT language="javascript" src="storage.js"></SCRIPT>
	<SCRIPT language="javascript" src="eventhandler.js"></SCRIPT>
	<script language="javascript" src="caseweb.js"></script>
	<!--<script language="javascript" src="https://intelitrade.github.io/caseweb/authtool/caseweb.js"></script>-->
	<!--<script language="javascript" src="http://localhost:8085/authtool/caseweb.js"></script>-->
	<script>
	document.onmouseup = mouseUp;
	</script>
</head>
<body onLoad="onLoad()" onunload="clearAllHighlighting()" scroll="no" style="margin:0px">
	<div id="header" align="center" width="100%" style="border: 1px solid #008CBA;background-color: #008CBA;color:#FFF;padding:0px;margin:0px">
		<table><tr><td><div id="" style="padding:0px;margin:0px"><h1 style="padding:5px;margin:5px"><b>Authoring Tool (Beta)</b></h1></div></td><td align="right"><div>
		<span><img title="Save project" id="" src="saveicon.png" style="width:50px;height:50px;" align="right;margin-right:55%" onclick="saveProject()"></span> 
		<span><img title="Preview (Currently available for specific tables - Beta)" id="" src="Document-Preview-icon.png" style="width:50px;height:50px;" align="right;margin-right:55%" onclick="previewDocument();"></span> <span disabled><img title="Make copy of selected item (Currently disabled)" id="xxx" src="makecopyof.png" style="width:50px;height:50px;" align="right;margin-right:55%" onclick=""></span> <span><img title="Delete slected item(s)" id="bin" src="bin.png" style="width:50px;height:50px;" align="right;margin-right:50%" onClick="deleteItem()"/></span></div></td></tr></table>
	</div>
	<div style="border: 1px solid #008CBA;margin-top:5px;">
		<table width="100%">
			<tr width="100%">
				<td width="20%">
					<div id="insertoptions" style="background-color:#008CBA;color:#FFFFFF;width:100%;font-weight: bold;height:40px;text-align:center">
						Insert Options<br>
						Drag & drop options into edit pane
					</div>				
					<div id="insertoptionsmain" style="overflow-y: auto;height:500px;width:100%">
						<ul class="categorytitle"><li style='padding:10px;'><b>Sections</b></li></ul>
						<ul style='margin-top:0px;margin-bottom:10px'>
							<li class="menulinespacer" sectiontype="NOTECONTROL">Note control</li>
							<li class="menulinespacer" sectiontype="SUBNOTECONTROL">Sub note control</li>
							<li class="menulinespacer" sectiontype="SUBNOTECONTROLGROUP">Sub note control (Group)</li>
							<li class="menulinespacer" sectiontype="EXPANDCOLLAPSE">Expand collapse</li>
							<li class="menulinespacer" sectiontype="EXPANDCOLLAPSECOMPANY3RDYEAR">Expand collapse (Company 3yr)</li>
						</ul>						
						<ul class="categorytitle">
							<li style='padding:10px;'><b>Table types</b></li>
						</ul>
						<ul style='margin-top:0px;margin-bottom:10px;'>
							<li class="menulinespacer" tabletype="CONTROLTABLE">Control table</li>
							<li class="menulinespacer" tabletype="STATEMENTTABLE">Statement table</li>
							<li class="menulinespacer" tabletype="MODIFIABLETABLE">Modifiable table</li>
							<li class="menulinespacer" tabletype="NOTETABLE">Note table</li>
							<li class="menulinespacer" tabletype="STD6COLUMNTABLE">Std 6 column table</li>
							<li class="menulinespacer" tabletype="SUMMARYTABLE">Summary table</li>
							<li class="menulinespacer" tabletype="SUMMARYTABLEGROUP">Summary table (Group)</li>
							<li class="menulinespacer" tabletype="RECONTABLE">Recon table</li>
							<li class="menulinespacer" tabletype="RADIOBUTTONTABLE">Radio button table</li>		
						</ul>
						<ul class="categorytitle">
							<li style='padding:10px;'><b>Row types</b></li>
						</ul>
						<ul style='margin-top:0px;margin-bottom:10px;'>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="C1" onmouseup="mouseUp()" name="Link to map row" rowtype="C1">Link to map row</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="C2" onmouseup="mouseUp()" name="Negative link to map row" rowtype="C2">Negative link to map row</li>	
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="C3" onmouseup="mouseUp()" name="Link to map (Debits only)" rowtype="C3">Link to map (Debits only)</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="G3" onmouseup="mouseUp()" name="Link to map (Credits only)" rowtype="G3">Link to map (Credits only)</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="C4" onmouseup="mouseUp()" name="Negative link to map (Debits only)" rowtype="C4">Negative link to map (Debits only)</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="C4" onmouseup="mouseUp()" name="Negative link to map (Credits only)" rowtype="G4">Negative link to map (Credits only)</li>	
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="A1" onmouseup="mouseUp()" name="Link to account" rowtype="A1">Link to account</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="A2" onmouseup="mouseUp()" name="Negative link to account" rowtype="A2">Negative link to account</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="I1" onmouseup="mouseUp()" name="Input row" rowtype="I1">Input row</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="D1" onmouseup="mouseUp()" name="Heading row" rowtype="D1">Heading row</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="S1" onmouseup="mouseUp()" name="Sub-total row" rowtype="S1">Sub-total row</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="L1" onmouseup="mouseUp()" name="Heading row" rowtype="L1">Thin line</li>
							<li class="menulinespacer" onmousedown="onMouseDown2(this.id)" id="L2" onmouseup="mouseUp()" name="Heading row" rowtype="L2">Thick line</li>
						</ul>
						<ul class="categorytitle"><li style='padding:10px;'><b>Paragraph</b></li></ul>
						<ul style='margin-top:0px;margin-bottom:10px;'>
							<li class="menulinespacer">Document</li>
							<li class="menulinespacer">Section</li>
							<li class="menulinespacer">Table</li>
							<li class="menulinespacer">Row</li>
						</ul>
						<ul class="categorytitle"><li style='padding:10px;'><b>Subdocument</b></li></ul>
						<ul style='margin-top:0px;margin-bottom:10px;'>
							<li class="menulinespacer">Header</li>
							<li class="menulinespacer">Footer</li>
							<li class="menulinespacer">External document</li>
						</ul>						
					</div>
				</td>			
				<td width="20%" style="border-left: 1px solid #008CBA;">
					<div id="docmapheading" style="background-color:#008CBA;color:#FFFFFF;width:100%;font-weight: bold;height:40px;text-align:center">
					</div>				
					<div id="MainContentContainer" style="overflow-y: auto;height:500px;width:100%">
					</div>
				</td>
				<td width="50%" style="border-left: 1px solid #008CBA;">
					<div id="" style="background-color:#008CBA;color:#FFFFFF;width:100%;font-weight:bold;text-align:center;height:40px">
						Details / Preview<br>Select an item in the "Edit options" panel to view / modify its properties
					</div>	
					<div style="overflow-y: auto;height:500px;width:100%;padding-left:5px;vertical-align: top;" id="editorPaneold">
						<table width="100%" height="100%">
							<tr>
								<td width="100%" height="100%" id="editorPane">
									<!--<object width="100%" height="400" data="PWC Illustrative Financial Statements 2013 - Financial statements - IFRS.pdf"></object>-->
								</td>
							</tr>
						</table>
					</div>
				</td>
			</tr>
		</table>
	</div>
	<div class="footer" id="results">
		<p style="margin-top:0; margin-bottom:0; line-height:.5"><br/></p>
		<table style="width: 100%">
			<tbody>
				<tr id="Buttons">
					<td align="right">
						<input align="left" class="button" id="ButtonOK" name="ButtonUpdate" onclick="okButtonClick()" type="button" value="OK" style="font-weight:bold" disabled title="Disabled for beta"/>
						<input align="left" class="button" id="ButtonApply" name="ButtonUpdate" onclick="ApplyButtonClick()" type="button" value="Apply" style="font-weight:bold" disabled title="Disabled for beta"/>
						<input align="left" class="button" id="ButtonCancel" name="ButtonCancel" onclick="cancelButtonClick()" type="button" value="Cancel" style="font-weight:bold"/>
					</td>
				</tr>
			</tbody>
		</table>
	</div>	
</body>
</html>
<script language="JavaScript">
	try{
	//window.focus();
	//debugger;
	//debugger;	
	//var iLoadProgBar = 1
	var oProgBar = oDoc.createProgressBar("Loading data...",1,1);
	
		if(sCType=="NOTECONTROL"||sCType=="SUBNOTECONTROL"||sCType=="EXPANDCOLLAPSE"||sCType=="SUBNOTECONTROLGROUP"||sCType=="EXPANDCOLLAPSECOMPANY3RDYEAR")
		{
			var sSectionLabel = sClosestSection;//"NOTES_002";
			
		}else{
			var sSectionLabel = sClosestSection = getCorrectContainer(sClosestSection);
		}
		buildTreeViewEx(sSectionLabel,oDoc);//,oProgBar);
	oProgBar.updateProgress(1);	
	oProgBar.destroyProgressBar();	
	}catch(e)
	{
		alert(e.description);
	}finally
	{

	}
	
	function getCorrectContainer(sSectionLabel)
	{
		//get the family tree of the section and start going up the tree to get the name
		//this might not be the case with content that has just been added
		var aOuterSections = getOuterSections(sSectionLabel,oDoc);
		if(isInputValid(aOuterSections))
		{
			for(var i=aOuterSections.length;i>=0;i--)
			{
				var sOuterSection = aOuterSections[i];
				var oOuterSection = oDoc.sectionByName(sOuterSection);
				if(oOuterSection)
				{
					var sOuterSectionCtype = oOuterSection.propGet("CTYPE");
					if(sOuterSectionCtype=="NOTECONTROL"||sOuterSectionCtype=="SUBNOTECONTROL"||sOuterSectionCtype=="EXPANDCOLLAPSE"||sOuterSectionCtype=="SUBNOTECONTROLGROUP"||sOuterSectionCtype=="EXPANDCOLLAPSECOMPANY3RDYEAR")
					{
						sSectionLabel = sOuterSection;
						//debugger;
						//debugger;
						//aSection.unshift(oOuterSection);
						break;
					}
				}
			}
		}
		return sSectionLabel;
	}	
</script>